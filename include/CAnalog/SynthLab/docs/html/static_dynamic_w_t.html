<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SynthLab SDK: Static &amp; Dynamic Wavetables</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SynthLab SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('static_dynamic_w_t.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Static &amp; Dynamic Wavetables </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>A key design feature in SynthLab is the use of generic interface classes that allow you to customize things that are programmer-centric (or perhaps company-centric) such as storing wavetables and PCM samples. The IWavetableSource and IWavetableDatabase objects are written so that the modules and cores have no information about how the data is stored. The IWavetableSource interface is below. You can see that its functions do not allow any kind of access to the underlying table itself. Think about how you will want to assembly your wavetable source object so that it conforms not only to this interface but also your own method for storing or creating the tables themselves. b<br />
</p>
<div class="fragment"><div class="line"><span class="comment">// --- comments removed</span></div><div class="line"><span class="keyword">class </span>IWavetableSource</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> selectTable(uint32_t midiNoteNumber) = 0;</div><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">double</span> readWaveTable(<span class="keywordtype">double</span> normalizedPhaseInc) = 0;</div><div class="line">    <span class="keyword">virtual</span> uint32_t getWaveTableLength() = 0;</div><div class="line">    <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* getWaveformName() = 0;</div><div class="line">};</div><div class="line"><span class="comment">//</span></div></div><!-- fragment --><p>When each wavetable core is reset, it queries the database to see if its tables exist or not. If a table does not exist, the core provides the IWavetableSource pointer for the database to store. The upshot of this is that the very first core of a given kind will register fresh tables with the database. After that, the other cores will find them, and not attempt to register them. <br />
</p>
<p>When the wavetable core is updated as part of the render operation, it will acquire a IWavetableSource pointer from the database and use it for all rendering. Many cores may be sharing access to the same table source. But the IWavetableSource interface only allows the core to call a function on it to read and interpolate the tables. <b>This means that no core will ever have access to the tables themselves, only to a function that will read the table for them.</b> Likewise, the cores do not control the lifecycles of the wavetable sources as they cannot create or destroy the tables.</p>
<h2>Static Wavetables </h2>
<p>Static wavetables are data arrays that are pre-initialized with their proper values. Figure 1 below shows three examples of static wavetable setups:</p><ol type="1">
<li>wavetables are compiled into the plugin from a .h file or other editable source code file</li>
<li>wavetables are compiled into the plugin with a binary data resource; a pre-assembled block of data that is added to the compiler project as a resource</li>
<li><p class="startli">wavetables in a datafile (in a known location) <b>and</b> apriori (advance) knowledge of the maximum number of tables, their lengths or other information needed to establish a static connection with the data</p>
<p class="startli"><br />
 </p><div class="image">
<img src="statictables.png" alt="statictables.png"/>
</div>
<p> <br />
</p>
</li>
</ol>
<p>SynthLab comes with three objects subclassed from IWavetableSource specifically for static sources; all of these may operate on one-shot or looping wavetables:</p><ol type="1">
<li>SineTableSource: includes one and only one table - a sinusoid</li>
<li>StaticTableSource: for pitched wavetables</li>
<li>DrumWTSource: for unpitched tables</li>
</ol>
<p>There are several static wavetable cores provided as examples:</p><ul>
<li>ClassicWTCore: uses a StaticTableSource for each waveform</li>
<li>MorphWTCore: uses a <b>set</b> of StaticTableSources, organized as a bank, up to 16 waveforms in size</li>
<li>DrumWTCore: uses a DrumWTSource for each one-shot drum table</li>
</ul>
<p>When examining the sample projects, notice where the statically declared wavetable sources are located for each oscillator core:</p><ul>
<li>ClassicWTCore: declares the array of sources as a member</li>
<li>MorphWTCore: uses a <b>set</b> of StaticTableSources, declared as an array of sources for each wavetable bank structure (see MorphBankData) - the MorphWTCore owns a set of 16 MorphBankData structures, one for each of its 16 bank names</li>
<li>DrumWTCore: declares the array of sources as a member</li>
</ul>
<h2>Static Wavetables in Data Files </h2>
<p>If you plan on storing tables in a datafile (brick) on the drive somewhere, you will have a few decisions to make about how and when you access them and how you plan on creating the IWavetableSource object that will register with the database. These are going to also be very programmer-centric (or company-centric) chores. If you know before-hand (at compile time) how the file is arranged along with the number and sizes of the tables, <b>then you can consider this to be a static wavetable implementation</b> as you can pre-allocate the IWavetableSource objects statically. How you setup the datafile accesses and read operations will be up to you, but the underlying module cores will only be able to call the IWavetableSource functions and the data will need to be available for them. <br />
</p>
<p>If you do not know the contents or other "maximum" information about the data file at compile time, then you will need to use a dynamic wavetable system.</p>
<h2>Dynamic Wavetables </h2>
<p>Dynamic wavetables are data arrays that are created dynamically at or after instantiation time for the plugin. SynthLab includes a dynamic wavetable core named FourierWTCore that synthesizes a parabola waveform during the reset operation and whose harmonic content is related to the sample rate. This core uses the DynamicTableSource object that is designed for holding a std::shared_ptr&lt;double&gt; that is created during the reset operation. I am using a smart pointer here so I don't need to worry with dynamic allocation lifecycles, but you may certainly use new/delete. <br />
</p>
<p><br />
 </p><div class="image">
<img src="synthlab_4.png" alt="synthlab_4.png"/>
</div>
<p> <br />
 </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>

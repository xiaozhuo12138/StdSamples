<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SynthLab SDK: Oscillator</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SynthLab SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ex_w_t_o.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Oscillator </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The oscillator objects are fundamentally identical except in their rendering operations. <br />
</p>
<p>There are two oscillators that do not require any additional files or support:</p><ul>
<li><b>VAOscillator</b>: virtual analog oscillator whose synthesis method is algorithmic</li>
<li><b>KSOscillator</b>: Karplus-Strong plucked string modeling, does not require tables or samples</li>
</ul>
<p>There are two oscillators that do require additional files:</p><ul>
<li><b>WTOscillator</b>: uses pre-built table files, and the wavetable database to register, store and retrieve them</li>
<li><b>PCMOscillator</b>: uses WAV files for storing samples, and the PCM sample database to register, store and retrieve them</li>
</ul>
<p>In this section, we'll work with the WTOscillator object, and using the other oscillator objects will work the same way; when in stanalone mode, there is really nothing to do but let the object maintain its own database and data-accesses. <br />
</p>
<p>The <b><a class="el" href="class_synth_lab_1_1_w_t_oscillator.html" title="Wavetable oscillator module. ">SynthLab::WTOscillator</a></b> object renders audio samples into its AudioBuffer output array. Under normal synth operation you will want to render and process blocks of audio data rather than individual samples (see the SynthBook for more reasoning and ramifiations of this). We will setup this standalone object to render audio blocks of 64 samples per channel (called 64 "frames") and you can test this with your plugin framework by piping the output data samples to your framework's audio output buffer.</p>
<p>You will need to add the following files for the WTOscillator (it includes 4 corse plus a bonus core)</p><ul>
<li><a class="el" href="wtoscillator_8h.html" title="See also Designing Software Synthesizers in C++ 2nd Ed. by Will Pirkle. ">wtoscillator.h</a> and <a class="el" href="wtoscillator_8cpp.html" title="See also Designing Software Synthesizers in C++ 2nd Ed. by Will Pirkle. ">wtoscillator.cpp</a></li>
<li><a class="el" href="classicwtcore_8h.html" title="See also Designing Software Synthesizers in C++ 2nd Ed. by Will Pirkle. ">classicwtcore.h</a> and <a class="el" href="classicwtcore_8cpp.html" title="See also Designing Software Synthesizers in C++ 2nd Ed. by Will Pirkle. ">classicwtcore.cpp</a></li>
<li><a class="el" href="drumwtcore_8h.html" title="See also Designing Software Synthesizers in C++ 2nd Ed. by Will Pirkle. ">drumwtcore.h</a> and <a class="el" href="drumwtcore_8cpp.html" title="See also Designing Software Synthesizers in C++ 2nd Ed. by Will Pirkle. ">drumwtcore.cpp</a></li>
<li><a class="el" href="fourierwtcore_8h.html" title="See also Designing Software Synthesizers in C++ 2nd Ed. by Will Pirkle. ">fourierwtcore.h</a> and <a class="el" href="fourierwtcore_8cpp.html" title="See also Designing Software Synthesizers in C++ 2nd Ed. by Will Pirkle. ">fourierwtcore.cpp</a></li>
<li><a class="el" href="morphwtcore_8h.html" title="See also Designing Software Synthesizers in C++ 2nd Ed. by Will Pirkle. ">morphwtcore.h</a> and <a class="el" href="morphwtcore_8cpp.html" title="See also Designing Software Synthesizers in C++ 2nd Ed. by Will Pirkle. ">morphwtcore.cpp</a></li>
<li><a class="el" href="sfxwtcore_8h.html" title="See also Designing Software Synthesizers in C++ 2nd Ed. by Will Pirkle. ">sfxwtcore.h</a> and <a class="el" href="sfxwtcore_8cpp.html" title="See also Designing Software Synthesizers in C++ 2nd Ed. by Will Pirkle. ">sfxwtcore.cpp</a></li>
</ul>
<p>Follow the same pattern and start with the class documentation. The WTOscillator:</p>
<ul>
<li>uses a WTOscParameters structure for control, both GUI and programatically</li>
<li>renders values into its own AudioBuffer object</li>
<li>includes 5 WT Oscillator cores (only four are loaded): ClassicWtCore, DrumWTCore, FourierWTCore, MorphWTCore, and SFXWTcore</li>
</ul>
<p>We'll choose the <a class="el" href="class_synth_lab_1_1_fourier_w_t_core.html" title="Fourier wavetable oscillator with sine and parabola waveforms. ">SynthLab::FourierWTCore</a> object (index = 2, see docs for WTOscillator class) and jump to its documentation. There we can find the module strings and mod knob assignments. The ModuleStrings are the two Fourier synthesized waveforms:</p>
<p>Module Strings, zero-indexed for your GUI Control:</p><ul>
<li>sinewave, parabola</li>
</ul>
<p>We will choose the parabola waveform, which as a zero-indexed string entry is [1]. Next, look at the documentation to find the output data (render) location <br />
</p>
<p>From the docs on FourierWTCore:</p><ul>
<li>renders into the output buffer</li>
<li>renders one block of audio per render cycle</li>
</ul>
<p>Note that the WTOscillator documentation also shows you how to create the object in standalone mode, we can use this code verbatim because we will setup a blocksize of 64 for this oscillator.</p>
<div class="fragment"><div class="line"><span class="comment">// --- standalone construction, block size = 64</span></div><div class="line">WTOscillator(<span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, 64);</div><div class="line"><span class="comment">//</span></div></div><!-- fragment --><p>So, we will do the following:</p><ol type="1">
<li>create the Oscillator and pass nullptr for the MIDI input, wavetable database, and parameters arguments</li>
<li>reset it with the sample rate</li>
<li>select the FourierWTCore (index = 2)</li>
<li>use getParameters: set the waveform index (parabola = 1) and outut amplitude = -3dB</li>
<li>create a MIDI event and call the note-on handler</li>
<li>call the render function to generate a block of rendered data (send that to your plugin framework output buffer)</li>
<li>call the note-off handler when note event is done</li>
</ol>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="wtoscillator_8h.html">wtoscillator.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="comment">// --- create a LFO via shared pointer; here is the definition</span></div><div class="line">std::unique_ptr&lt;SynthLab::WTOscillator&gt; wtOsc = <span class="keyword">nullptr</span>;</div><div class="line"></div><div class="line"><span class="comment">// --- here is the creation</span></div><div class="line">wtOsc.reset(<span class="keyword">new</span> <a class="code" href="class_synth_lab_1_1_w_t_oscillator.html">SynthLab::WTOscillator</a>(<span class="keyword">nullptr</span>, <span class="comment">/* MIDI input data */</span></div><div class="line">                                       <span class="keyword">nullptr</span>, <span class="comment">/* WT parameters */</span></div><div class="line">                                       <span class="keyword">nullptr</span>, <span class="comment">/* wavetable database */</span></div><div class="line">                                       64));    <span class="comment">/* audio block size (64 samples per channel)*/</span></div><div class="line"></div><div class="line"><span class="comment">// --- initialize</span></div><div class="line">wtOsc-&gt;reset(44100.0); <span class="comment">//&lt;- get fs from your framework</span></div><div class="line"></div><div class="line"><span class="comment">// --- select core #2: FourierWTCore</span></div><div class="line">wtOsc-&gt;selectModuleCore(2);</div><div class="line"></div><div class="line"><span class="comment">// --- get the parameter struct pointer; </span></div><div class="line"><span class="comment">//     it was synthesized when we passed a nullptr into the constructor</span></div><div class="line">std::shared_ptr&lt;SynthLab::WTOscParameters&gt; wtoParameters = wtOsc-&gt;getParameters();</div><div class="line"><span class="keywordflow">if</span> (wtoParameters) <span class="comment">// should never fail</span></div><div class="line">{</div><div class="line">    <span class="comment">// --- set the variables</span></div><div class="line">    wtoParameters-&gt;waveIndex = 1; <span class="comment">// FourierWTCore parabola</span></div><div class="line">    wtoParameters-&gt;outputAmplitude_dB = -3.0;</div><div class="line"></div><div class="line">    <span class="comment">// --- call the update function (only needs to be done once per render cycle)</span></div><div class="line">    wtOsc-&gt;update();</div><div class="line">}</div><div class="line"><span class="comment">// ---</span></div></div><!-- fragment --><p>Now, in response to a MIDI note-on message, we setup a MIDIEvent structure (NOTE: we added the call to the pitch calculaton prior to the note-on function call):</p>
<div class="fragment"><div class="line"><span class="comment">// --- prepare a MIDI event for note-on</span></div><div class="line"><a class="code" href="struct_synth_lab_1_1_m_i_d_i_note_event.html">SynthLab::MIDINoteEvent</a> midiEvent;</div><div class="line">midiEvent.<a class="code" href="struct_synth_lab_1_1_m_i_d_i_note_event.html#ab39c1eb0f451972d37592e99636f8e06">midiNoteNumber</a> = 60;</div><div class="line">midiEvent.<a class="code" href="struct_synth_lab_1_1_m_i_d_i_note_event.html#a7c1a0e203aa66105e2f69d3f2850881d">midiPitch</a> = <a class="code" href="group___m_i_d_i_functions.html#gad3b90b92d9aa8104d1b4fa897b5db750">SynthLab::midiNoteNumberToOscFrequency</a>(midiEvent.<a class="code" href="struct_synth_lab_1_1_m_i_d_i_note_event.html#ab39c1eb0f451972d37592e99636f8e06">midiNoteNumber</a>); <span class="comment">//&lt; PITCH Calculation</span></div><div class="line">midiEvent.<a class="code" href="struct_synth_lab_1_1_m_i_d_i_note_event.html#a93dce735febfe26bc91a4b17922adec9">midiNoteVelocity</a> = 127;</div><div class="line"></div><div class="line"><span class="comment">// --- send note event</span></div><div class="line">wtOsc-&gt;doNoteOn(midiEvent);</div><div class="line"><span class="comment">// ---</span></div></div><!-- fragment --><p>At this point, we can start to render values from the oscillator. This shows how to grab the left and right samples from the oscillator's output array; notic the use of the constants:</p><ul>
<li><b>LEFT_CHANNEL</b>: array slot [0] in the buffer</li>
<li><b>RIGHT_CHANNEL</b>: array slot [1] in the buffer</li>
</ul>
<div class="fragment"><div class="line"><span class="comment">// --- render OSC output</span></div><div class="line">wtOsc-&gt;render(64); <span class="comment">// render a block of 64</span></div><div class="line"></div><div class="line"><span class="comment">// --- get pointers to output buffers</span></div><div class="line"><span class="keywordtype">float</span>* leftOutBuffer = wtOsc-&gt;getAudioBuffer()-&gt;getOutputBuffer(SynthLab::LEFT_CHANNEL);</div><div class="line"><span class="keywordtype">float</span>* rightOutBuffer = wtOsc-&gt;getAudioBuffer()-&gt;getOutputBuffer(SynthLab::RIGHT_CHANNEL);</div><div class="line"></div><div class="line"><span class="comment">// --- loop over buffers to access samples; loop maximum (64) set manually here</span></div><div class="line"><span class="keywordflow">for</span> (uint32_t i = 0; i &lt; 64; i++)</div><div class="line">{</div><div class="line">     <span class="keywordtype">float</span> leftSample = leftOutBuffer[i];</div><div class="line">     <span class="keywordtype">float</span> rightSample = rightOutBuffer[i];</div><div class="line">     </div><div class="line">     <span class="comment">// --- SEND THESE OUTPUTS TO YOUR FRAMEWORK or play with them</span></div><div class="line">}</div><div class="line"><span class="comment">// ---</span></div></div><!-- fragment --><p>From here you can keep rendering until the note-off message arrives. Technically, the note-off handler can access the MIDI note number, but in the case of the wavetable oscillator, this value is not used. In fact, most of the objects have note-off handers that are empty. The EGs are a notable exception.</p>
<div class="fragment"><div class="line"><span class="comment">// --- prepare a MIDI event for note-off</span></div><div class="line"><a class="code" href="struct_synth_lab_1_1_m_i_d_i_note_event.html">SynthLab::MIDINoteEvent</a> midiEvent;</div><div class="line">midiEvent.<a class="code" href="struct_synth_lab_1_1_m_i_d_i_note_event.html#ab39c1eb0f451972d37592e99636f8e06">midiNoteNumber</a> = 60;      <span class="comment">// &lt;- get from your framework</span></div><div class="line">midiEvent.<a class="code" href="struct_synth_lab_1_1_m_i_d_i_note_event.html#a7c1a0e203aa66105e2f69d3f2850881d">midiPitch</a> = <a class="code" href="group___m_i_d_i_functions.html#gad3b90b92d9aa8104d1b4fa897b5db750">SynthLab::midiNoteNumberToOscFrequency</a>(midiEvent.<a class="code" href="struct_synth_lab_1_1_m_i_d_i_note_event.html#ab39c1eb0f451972d37592e99636f8e06">midiNoteNumber</a>); <span class="comment">//&lt; PITCH Calculation</span></div><div class="line">midiEvent.<a class="code" href="struct_synth_lab_1_1_m_i_d_i_note_event.html#a93dce735febfe26bc91a4b17922adec9">midiNoteVelocity</a> = 0;     <span class="comment">// &lt;- get from your framework</span></div><div class="line"></div><div class="line"><span class="comment">// --- send note event</span></div><div class="line">wtOsc-&gt;doNoteOff(midiEvent);</div><div class="line"><span class="comment">// ---</span></div></div><!-- fragment --><p>Now, experiment with changing the OSC parameters (see the WTOscParameter documentation to see what you can change). Also, try experimenting with the mod knobs (see SynthLFO tutorial above)</p>
<p><br />
 </p><div class="image">
<img src="synthlab_4.png" alt="synthlab_4.png"/>
</div>
<p> <br />
 </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">SynthLab Developer&#39;s Guide</a></li><li class="navelem"><a class="el" href="standalone.html">Standalone Programming</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>

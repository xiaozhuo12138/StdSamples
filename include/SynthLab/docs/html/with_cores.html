<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SynthLab SDK: SynthModule With Cores</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SynthLab SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('with_cores.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">SynthModule With Cores </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>So far, we've been using the following SynthModules that are all designed with the ModuleCore paradigm and you have seen most of their inner workings as a result of researching the practice objects we've made so far. These are <b>container</b> modules whose main job is to maintain their set of cores, select them, and then call functions on them as needed. <br />
</p>
<p>If you want to create a container module, the coding is relatively simple using the template files and the only thing you really need to modify will be the addition of shared databases (if needed) and altering the type of custom GUI parameter structure will be used. The rest of the code may be left intact and without modification. <br />
</p>
<h2>Empty SynthModule Template </h2>
<p>The SDK contains a pair of source files for an empty SynthModule that is a core container object in the files <b><a class="el" href="synthmodule__withcores_8h.html" title="See also Designing Software Synthesizers in C++ 2nd Ed. by Will Pirkle. ">synthmodule_withcores.h</a></b> and <b><a class="el" href="synthmodule__withcores_8cpp.html" title="See also Designing Software Synthesizers in C++ 2nd Ed. by Will Pirkle. ">synthmodule_withcores.cpp</a></b>. Use this as a starting point for your own modules that contain cores. It's constructor is setup to accept a <b>ficitious</b> shared SynthModuleWithCores parameter structure and you will need to change that for your particular object. You may also need to add an argument to the constructor if:</p><ol type="1">
<li>you are implementing a wavetable synth, where you will want to add the wavetable database interface pointer like this (note also the change of the parameter structure type)</li>
<li>you are implementing a PCM Sample synth, where you will want to add the PCMSample database interface pointer like this (note also the change of the parameter structure type)</li>
</ol>
<p>Wavetable database: </p><div class="fragment"><div class="line"><span class="comment">// --- synth module with wavetable database</span></div><div class="line">SynthModuleWithCores(std::shared_ptr&lt;MidiInputData&gt; _midiInputData,</div><div class="line">     std::shared_ptr&lt;WTOscParameters&gt; _parameters,</div><div class="line">     std::shared_ptr&lt;WavetableDatabase&gt; _waveTableDatabase,</div><div class="line">     uint32_t blockSize = 64);  </div><div class="line"><span class="comment">//</span></div></div><!-- fragment --><p>PCM Sample Database: </p><div class="fragment"><div class="line"><span class="comment">// --- synth module with PCM database</span></div><div class="line">SynthModuleWithCores(std::shared_ptr&lt;MidiInputData&gt; _midiInputData,</div><div class="line">     std::shared_ptr&lt;PCMOscParameters&gt; _parameters,</div><div class="line">     std::shared_ptr&lt;PCMSampleDatabase&gt; _sampleDatabase,</div><div class="line">     uint32_t blockSize = 64);  </div><div class="line"><span class="comment">//</span></div></div><!-- fragment --><p>The majority of the operational functions just forward the function calls to either the selected core, or to all of the cores depending on the kind of function. Check out that code which is very lean and simple. Notice that the render() function calls its own update() function first to force the core update to occur just prior to render(). <b>Make sure you do not accidentally call the update() function twice in your projects.</b></p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> SynthModuleWithCores::update()</div><div class="line">{</div><div class="line">     coreProcessData.unisonDetuneCents = unisonDetuneCents;</div><div class="line">     <span class="keywordflow">if</span>(!selectedCore) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line">     <span class="keywordflow">return</span> selectedCore-&gt;update(coreProcessData);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">bool</span> SynthModuleWithCores::render(uint32_t samplesToProcess)</div><div class="line">{</div><div class="line">     <span class="comment">// --- update parameters for this block</span></div><div class="line">     update();</div><div class="line">     coreProcessData.samplesToProcess = samplesToProcess;</div><div class="line">     <span class="keywordflow">if</span>(!selectedCore) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line">     <span class="keywordflow">return</span> selectedCore-&gt;render(coreProcessData);</div><div class="line">}</div><div class="line"><span class="comment">//</span></div></div><!-- fragment --><p>The constructor is important because it is where the audio buffers and default parameters are synthesized. It is also where the all-important coreProcessData member is initialized with the values that the cores will need to do their work. After that, the cores are created and added. The majority of the variables and methods are from the SynthModule base class.</p>
<div class="fragment"><div class="line">SynthModuleWithCores::SynthModuleWithCores(std::shared_ptr&lt;MidiInputData&gt; _midiInputData,</div><div class="line">     std::shared_ptr&lt;OscParameters&gt; _parameters,</div><div class="line">     uint32_t blockSize)</div><div class="line">: SynthModule(_midiInputData)</div><div class="line">, parameters(_parameters)</div><div class="line">{</div><div class="line">     <span class="comment">// --- standalone ONLY: parameters</span></div><div class="line">     <span class="keywordflow">if</span> (!parameters)</div><div class="line">     parameters.reset(<span class="keyword">new</span> OscParameters);</div><div class="line"></div><div class="line">     <span class="comment">// --- create our audio buffers</span></div><div class="line">     audioBuffers.reset(<span class="keyword">new</span> SynthProcessInfo(<a class="code" href="group___constants-_enums.html#ga353c6724238f64d1dad29158be0da0aa">OSC_INPUTS</a>, <a class="code" href="group___constants-_enums.html#ga3ccb315d3dec45c949eafb39cea0bc34">OSC_OUTPUTS</a>, blockSize));</div><div class="line"></div><div class="line">    <span class="comment">// --- setup the core processing structure for dynamic cores</span></div><div class="line">     coreProcessData.inputBuffers = getAudioBuffers()-&gt;getInputBuffers();</div><div class="line">     coreProcessData.outputBuffers = getAudioBuffers()-&gt;getOutputBuffers();</div><div class="line">     coreProcessData.modulationInputs = modulationInput-&gt;getModulatorPtr();</div><div class="line">     coreProcessData.modulationOutputs = modulationOutput-&gt;getModulatorPtr();</div><div class="line">     coreProcessData.moduleParameters = parameters.get();</div><div class="line">     coreProcessData.midiInputData = midiInputData-&gt;getIMIDIInputData();</div><div class="line"></div><div class="line">     <span class="comment">// --- add up to 4 cores here like this:</span></div><div class="line">     <span class="comment">//</span></div><div class="line">     <span class="comment">//     std::shared_ptr&lt;OscCore&gt; defaultCore = std::make_shared&lt;OscCore&gt;();</span></div><div class="line">     <span class="comment">//     addModuleCore(std::static_pointer_cast&lt;ModuleCore&gt;(defaultCore));</span></div><div class="line"></div><div class="line"></div><div class="line">     <span class="comment">// --- core[0]</span></div><div class="line">     selectDefaultModuleCore();</div><div class="line"></div><div class="line">} </div><div class="line"><span class="comment">/* C-TOR */</span></div></div><!-- fragment --><p>From this point, you will use this module just like all the others you've used so far. The interface functions are identical and for testing you only need to worry about the kind of custom parameter structure the module requires.</p>
<p><br />
 </p><div class="image">
<img src="synthlab_4.png" alt="synthlab_4.png"/>
</div>
<p> <br />
 </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">SynthLab Developer&#39;s Guide</a></li><li class="navelem"><a class="el" href="synth_modules.html">SynthModule Progamming</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
